<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="renderer" content="webkit" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, user-scalable=0"
    />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="format-detection" content="telephone=no" />
    <title>R4轮播图</title>
    <link rel="stylesheet" type="text/css" href="./css/swiper.min.css" />
    <link rel="stylesheet" type="text/css" href="./css/index.css" />
  </head>

  <body>
    <div class="swiper-wrapper-mask">
      <div class="swiper-container">
        <div class="swiper-wrapper">
          <!-- <div class="swiper-slide">
          <img src="./static/banner01.png" alt="" width="100%" />
        </div>
        <div class="swiper-slide">
          <img src="./static/banner02.png" alt="" width="100%" />
        </div>
        <div class="swiper-slide">
          <img src="./static/banner03.png" alt="" width="100%" />
        </div>
        <div class="swiper-slide">
          <img src="./static/banner04.png" alt="" width="100%" />
        </div> -->
        </div>
      </div>
      <!-- 如果需要分页器 -->
      <!-- <div class="swiper-pagination"></div>
    <div class="waves">
      <img width="100%" src="./static/bg.png" />
    </div> -->
    </div>
    <script src="./js/swiper.min.js"></script>
    <script src="./js/jquery.js"></script>

    <script>
      $.ajax({
        url: "r4data.json?ver=" + new Date().getTime(),
        type: "GET"
      })
        .done(function(data) {
          var swiperStr = "",
            bgStr = "",
            defaultKey = "全国";
          var r4data = data[getParameterByName("province")]
            ? data[getParameterByName("province")]
            : data[defaultKey];
          var swiperData = [];
          for (var i = 0; i < r4data.length; i++) {
            if (r4data[i].type === "1") {
              bgStr =
                '<div class="swiper-pagination"></div>' +
                '<div class="waves">' +
                '<img width="100%" src="' +
                r4data[i].img +
                '" />' +
                "</div>";
            } else {
              swiperStr +=
                '<div class="swiper-slide">' +
                '<img src="' +
                r4data[i].img +
                '" alt="" width="100%" />' +
                "</div>";
              swiperData.push(r4data[i]);
            }
          }

          $(".swiper-wrapper").append(swiperStr);
          $(".swiper-wrapper-mask").append(bgStr);
          // console.log(swiperData);
          var swiper = new Swiper(".swiper-container", {
            speed: 600,
            centeredSlides: true,
            autoplay: {
              delay: 3000,
              disableOnInteraction: false
            },
            loop: true,
            pagination: {
              el: ".swiper-pagination"
            },
            on: {
              tap: function(e) {
                var swiperLen = swiperData.length;
                var index =
                  this.clickedIndex === swiperLen + 1
                    ? 0
                    : this.clickedIndex - 1;
                // console.log(
                //   "点击的index:" + this.clickedIndex,
                //   "获取到的" + index
                // );
                // console.log("需要跳转的地址为 ==> " + swiperData[index].url);
                // console.log("title为 ==> " + swiperData[index].title);
                var url = swiperData[index].url;
                var title = swiperData[index].title
                  ? swiperData[index].title
                  : "";
                if (url) {
                  window.smrz.launchH5(url, title);
                }
              }
            }
          });
        })
        .fail(function() {
          console.log("error");
        });
      //获取页面链接参数
      function getParameterByName(name, url) {
        if (!url) url = window.location.href;
        name = name.replace(/[\[\]]/g, "\\$&");
        var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
          results = regex.exec(url);
        if (!results) return null;
        if (!results[2]) return "";
        return decodeURIComponent(results[2]);
      }
    </script>
  </body>
</html>
